import{ad as T,a1 as k,ae as H,af as M,ag as D}from"./entry.DjYp6XJk.js";function C(t,r,i){T(()=>{var n=k(()=>r(t,i==null?void 0:i())||{});if(n!=null&&n.destroy)return()=>n.destroy()})}function F(t){const r=JSON.parse(t);return r.data&&(r.data=H(r.data)),r}function m(t){return HTMLElement.prototype.cloneNode.call(t)}function N(t,r=()=>{}){const i=async({action:e,result:l,reset:o=!0,invalidateAll:c=!0})=>{l.type==="success"&&(o&&HTMLFormElement.prototype.reset.call(t),c&&await M()),(location.origin+location.pathname===e.origin+e.pathname||l.type==="redirect"||l.type==="error")&&D(l)};async function n(e){var b,y,h,w,A;if(((b=e.submitter)!=null&&b.hasAttribute("formmethod")?e.submitter.formMethod:m(t).method)!=="post")return;e.preventDefault();const o=new URL((y=e.submitter)!=null&&y.hasAttribute("formaction")?e.submitter.formAction:m(t).action),c=(h=e.submitter)!=null&&h.hasAttribute("formenctype")?e.submitter.formEnctype:m(t).enctype,u=new FormData(t),d=(w=e.submitter)==null?void 0:w.getAttribute("name");d&&u.append(d,((A=e.submitter)==null?void 0:A.getAttribute("value"))??"");const p=new AbortController;let f=!1;const L=await r({action:o,cancel:()=>f=!0,controller:p,formData:u,formElement:t,submitter:e.submitter})??i;if(f)return;let s;try{const a=new Headers({accept:"application/json","x-sveltekit-action":"true"});c!=="multipart/form-data"&&a.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(c)?c:"application/x-www-form-urlencoded");const x=c==="multipart/form-data"?u:new URLSearchParams(u),E=await fetch(o,{method:"POST",headers:a,cache:"no-store",body:x,signal:p.signal});s=F(await E.text()),s.type==="error"&&(s.status=E.status)}catch(a){if((a==null?void 0:a.name)==="AbortError")return;s={type:"error",error:a}}L({action:o,formData:u,formElement:t,update:a=>i({action:o,result:s,reset:a==null?void 0:a.reset,invalidateAll:a==null?void 0:a.invalidateAll}),result:s})}return HTMLFormElement.prototype.addEventListener.call(t,"submit",n),{destroy(){HTMLFormElement.prototype.removeEventListener.call(t,"submit",n)}}}export{C as a,N as e};
